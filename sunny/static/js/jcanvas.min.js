/**
 * jCanvas v13.08.12
 * Copyright 2013 Caleb Evans
 * Released under the MIT license
 */(function(e,t,n,r,i,s,o,u,a){function Tn(e){var t=this;un(t,e);return t}function Nn(e){e?un(Tn.prototype,e):Nn.prefs=Tn.prototype=un({},on);return this}function Cn(e){return fn(e)==="string"}function kn(e){return e&&e[O]?e[O]("2d"):u}function Ln(e){e=un({},e);e.masks=e.masks[gt](0);return e}function An(e,t){e.save();t[M].push(Ln(t[d]))}function On(e,t){if(t[M][f]===0)t[d]=Ln(En);else{e[lt]();t[d]=t[M].pop()}}function Mn(e,t,n){ln(n[E])?t[E]=n[E][w](e,n):t[E]=n[E];ln(n[N])?t[N]=n[N][w](e,n):t[N]=n[N];t.lineWidth=n[bt];if(n.rounded)t.lineCap=t.lineJoin="round";else{t.lineCap=n.strokeCap;t.lineJoin=n.strokeJoin;t.miterLimit=n.miterLimit}t.shadowOffsetX=n.shadowX;t.shadowOffsetY=n.shadowY;t[Ct]=n[Ct];t[m]=n[m];t.globalAlpha=n.opacity;t.globalCompositeOperation=n.compositing;n[Rt]&&(t.webkitImageSmoothingEnabled=t.mozImageSmoothingEnabled=n[Rt])}function _n(e,t,n){if(n.mask){n[mt]&&An(e,t);e.clip();t[d].masks.push(n._args)}}function Dn(e,t){t._transformed&&e[lt]()}function Pn(e,t,n){var r;n[pt]&&t[z]();if(n.shadowStroke&&n[bt]!==0){t.stroke();t.fill();t[m]=p;t[Ct]=0;t.stroke()}else{t.fill();n[E]!==p&&(t[m]=p);n[bt]!==0&&t.stroke()}n[pt]||t[z]();Dn(t,n);if(n.mask){r=In(e);_n(t,r,n)}}function Hn(e,t,n){t[j]=t[Lt]?hn/180:1;e[T](t.x,t.y);e[ft](t[ft]*t[j]);e[T](-t.x,-t.y);n[ft]+=t[ft]*t[j]}function Bn(e,t,n){t.scale!==1&&(t[ct]=t[ht]=t.scale);e[T](t.x,t.y);e.scale(t[ct],t[ht]);e[T](-t.x,-t.y);n[ct]*=t[ct];n[ht]*=t[ht]}function jn(e,t,n){t[T]&&(t[q]=t[I]=t[T]);e[T](t[q],t[I]);n[q]+=t[q];n[I]+=t[I]}function Fn(e,t,n,r,i){n[j]=n[Lt]?hn/180:1;n._transformed=s;t.save();i===a&&(i=r);if(!n.fromCenter&&!n._centered){n.x+=r/2;n.y+=i/2;n._centered=s}n[ft]&&Hn(t,n,{});(n.scale!==1||n[ct]!==1||n[ht]!==1)&&Bn(t,n,{});(n[T]||n[q]||n[I])&&jn(t,n,{})}function In(t){var n;if(bn._canvas===t&&bn._data)n=bn._data;else{n=e.data(t,ut);if(!n){n={canvas:t,layers:[],layer:{names:{},groups:{}},intersecting:[],drag:{},event:{type:u,x:u,y:u},events:{},transforms:Ln(En),savedTransforms:[],animating:o,animated:u,pixelRatio:1,scaled:!1};e.data(t,ut,n)}bn._canvas=t;bn._data=n}return n}function qn(e,t,n){var r;for(r in Nn[F])Nn[F][Ft](r)&&n[r]&&Rn(e,t,n,r)}function Rn(e,t,n,r){r=tr(r);Nn[F][r](e,t);n[v]=s}function Un(e,t,n){var r,i,o;if(n[$]||n[y]||n[Tt]){r=[V,P,nt];for(o=0;o<r[f];o+=1){i=r[o];Rn(e,t,n,i)}if(!t[F].mouseoutdrag){e.bind("mouseout.jCanvas",function(){var n=t.drag[c];if(n){t.drag={};n.dragcancel&&n.dragcancel[w](e[0],n);e[H]()}});t[F].mouseoutdrag=s}n[v]=s}}function zn(e,t,n,r){var i=t[c].names;r?r[rt]!==a&&Cn(n[rt])&&n[B]!==r[B]&&delete i[n[rt]]:r=n;Cn(r[rt])&&(i[r[rt]]=n)}function Wn(e,t,n,r){var i=t[c][dt],s,o,u;if(!r)r=n;else if(r[B]!==a&&Cn(n[B])&&n[B]!==r[B]){s=i[n[B]];if(s){for(u=0;u<s[f];u+=1)if(s[u]===n){o=u;s[b](u,1);break}s[f]===0&&delete i[n[B]]}}if(Cn(r[B])){s=i[r[B]];if(!s){s=i[r[B]]=[];s[rt]=r[B]}o===a&&(o=s[f]);s[b](o,0,n)}}function Xn(e){var t,n,r;t={};for(n=e[Y][f]-1;n>=0;n-=1){t=e[Y][n];if(t[Xt]){for(r=t[Xt][f]-1;r>=0;r-=1)if(!t[Xt][r][K]){t[K]=o;break}if(t[K])break}}return t}function Vn(e,t){var n,r,i,u,a;r=t.drag;i=t.layers;n=t[J].type;if(n===P||n===vt){if(!r[Mt]){r[Mt]=s;if(r[c].bringToFront){i[b](r[c][D],1);r[c][D]=i.push(r[c])}u=t[c][dt][r[c][B]];if(r[c][B]&&r[c][y]&&u)for(a=0;a<u[f];a+=1)if(u[a]!==r[c]){u[a][kt]=u[a].x;u[a][At]=u[a].y;u[a]._endX=r[c][ot];u[a]._endY=r[c][it];if(u[a].bringToFront){u[a][D]=an(u[a],i);i[b](u[a][D],1);i[b](-1,0,u[a]);u[a][D]=i[f]-2}u[a][Nt]&&u[a][Nt][w](e,u[a])}r[kt]=r[c][kt]=r[c].x;r[At]=r[c][At]=r[c].y;r._endX=r[c]._endX=r[c][ot];r._endY=r[c]._endY=r[c][it];r[c][Nt]&&r[c][Nt][w](e,r[c])}r[c].x=r[c][ot]-(r._endX-r[kt]);r[c].y=r[c][it]-(r._endY-r[At]);u=t[c][dt][r[c][B]];if(r[c][B]&&r[c][y]&&u)for(a=0;a<u[f];a+=1)if(u[a]!==r[c]){u[a].x=r[c][ot]-(u[a]._endX-u[a][kt]);u[a].y=r[c][it]-(u[a]._endY-u[a][At]);u[a].drag&&u[a].drag[w](e,u[a])}r[c].drag&&r[c].drag[w](e,r[c])}else if(n===nt||n===wt){if(r[c][Dt]&&r[Mt]){r[c][Dt][w](e,r[c]);r[Mt]=o}u=t[c][dt][r[c][B]];if(r[c][B]&&r[c][y]&&u)for(a=0;a<u[f];a+=1)u[a]!==r[c]&&u[a][Dt]&&u[a][Dt][w](e,u[a]);t.drag={}}}function $n(e,t,n,r){if(n&&n[S]&&n[A]){r?n._next=r:n._next=u;n[A][w](e,n)}}function Jn(t,n,r,i){var o,a,l=r,h;n._args=r;n.canvas=t;if(n[$]||n[y]){n[c]=s;n[$]=s}i?n[A]=i:n.method?n[A]=e.fn[n.method]:n.type?n[A]=e.fn[yn[n.type]]:n[A]=function(){};if(n[c]&&!n._layer){o=e(t);a=o[x]();h=In(t);l=new Tn(r);l[A]=n[A];l.canvas=n.canvas;l[$]=n[$];l[c]=s;l._layer=s;zn(o,h,l);Wn(o,h,l);qn(o,h,l);Un(o,h,l);n[v]=l[v];l[D]===u&&(l[D]=a[f]);a[b](l[D],0,l)}return l}function Kn(e){var t;for(t=0;t<Sn[f];t+=1)e[Sn[t]]=e["_"+Sn[t]]}function Qn(e,t){var n;for(n=0;n<Sn[f];n+=1){e["_"+Sn[n]]=e[Sn[n]];xn[Sn[n]]=1;t&&delete e[Sn[n]]}}function Gn(e,t,n){var r;for(r in n)n[Ft](r)&&ln(n[r])&&(n[r]=n[r][w](e,t,r));return n}function Yn(n){var r,s,o=[],u=1;if(n[rn](/^#?\w+$/gi)){n===p&&(n="rgba(0,0,0,0)");s=t.head;r=s[xt][Bt];s[xt][Bt]=n;n=e.css(s,Bt);s[xt][Bt]=r}if(n[rn](/^rgb/gi)){o=n[rn](/\d+/gi);n[rn](/%/gi)&&(u=2.55);o[0]*=u;o[1]*=u;o[2]*=u;o[3]!==a?o[3]=i(o[3]):o[3]=1}return o}function Zn(e){var t=3,n;if(fn(e[U])!=="array"){e[U]=Yn(e[U]);e.end=Yn(e.end)}e.now=[];if(e[U][3]!==1||e.end[3]!==1)t=4;for(n=0;n<t;n+=1){e.now[n]=e[U][n]+(e.end[n]-e[U][n])*e.pos;n<3&&(e.now[n]=cn(e.now[n]))}if(e[U][3]!==1||e.end[3]!==1)e.now="rgba("+e.now.join(",")+")";else{e.now[gt](0,3);e.now="rgb("+e.now.join(",")+")"}e.elem.nodeName?e.elem[xt][e.prop]=e.now:e.elem[e.prop]=e.now}function er(t){var n;for(n=0;n<t[f];n+=1)e.fx.step[t[n]]=Zn}function tr(e){window.ontouchstart!==undefined&&mn[e]&&(e=mn[e]);return e}function nr(e){gn[e]&&(e=gn[e]);return e}function rr(e){Nn[F][e]=function(t,n){var r,i;i=n[J];r=e===W||e===Z?P:e;if(!n[F][r]){t.bind(r+".jCanvas",function(e){i.x=e[$t];i.y=e.offsetY;i.type=r;i[J]=e;t[H]({resetFire:s});e.preventDefault()});n[F][r]=s}}}function ir(e){var t;for(t=0;t<e[f];t+=1)rr(e[t])}function sr(e,t,n){var r,i,o,a,f,l,c,h;r=n._args;if(r[v]){i=In(e);o=i[J];if(o.x!==u&&o.y!==u){l=o.x*i[It];c=o.y*i[It];a=t.isPointInPath(l,c)||t[Vt]&&t[Vt](l,c)}f=i[d];r.eventX=r.mouseX=o.x;r.eventY=r.mouseY=o.y;r[J]=o[J];h=i[d][ft];l=r.eventX;c=r.eventY;if(h!==0){r[ot]=l*dn(-h)-c*pn(-h);r[it]=c*dn(-h)+l*pn(-h)}else{r[ot]=l;r[it]=c}r[ot]/=f[ct];r[it]/=f[ht];!a&&r[Ot]&&!r[St]&&(r[Ht]=s);a&&i[Y].push(r);r[K]=a}}function or(e,t){isNaN(Number(t[k]))||(t[k]+="px");e.font=t[Jt]+" "+t[k]+" "+t[jt]}function ur(t,n,r,s){var o,u,a;if(bn.text===r.text&&bn[Jt]===r[Jt]&&bn[k]===r[k]&&bn[jt]===r[jt]&&bn[_t]===r[_t]&&bn[et]===r[et]){r[h]=bn[h];r[l]=bn[l]}else{r[h]=n[R](s[0])[h];for(a=1;a<s[f];a+=1){u=n[R](s[a])[h];u>r[h]&&(r[h]=u)}o=t[xt][k];t[xt][k]=r[k];r[l]=i(e.css(t,k))*s[f]*r[et];t[xt][k]=o}}function ar(e,t){var n=t.text,r=t[_t],i=n.split(" "),s,o=[],u="";if(i[f]===1||e[R](n)[h]<r)o=[n];else{for(s=0;s<i[f];s+=1){if(e[R](u+i[s])[h]>r){u!==""&&o.push(u);u=""}u+=i[s];s!==i[f]-1&&(u+=" ")}o.push(u)}o=o.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n");return o}var f="length",l="height",c="layer",h="width",p="transparent",d="transforms",v="_event",m="shadowColor",g="beginPath",y="dragGroupWithLayer",b="splice",w="call",E="fillStyle",S="visible",x="getLayers",T="translate",N="strokeStyle",C="getLayerGroup",k="fontSize",L="getLayer",A="_method",O="getContext",M="savedTransforms",_="sHeight",D="index",P="mousemove",H="drawLayers",B="group",j="_toRad",F="events",I="translateY",q="translateX",R="measureText",U="start",z="closePath",W="mouseover",X="sWidth",V="mousedown",$="draggable",J="event",K="intersects",Q="radius",G="drawImage",Y="intersecting",Z="mouseout",et="lineHeight",tt="animating",nt="mouseup",rt="name",it="_eventY",st="lineTo",ot="_eventX",ut="jCanvas",at="touchstart",ft="rotate",lt="restore",ct="scaleX",ht="scaleY",pt="closed",dt="groups",vt="touchmove",mt="autosave",gt="slice",yt="bezierCurveTo",bt="strokeWidth",wt="touchend",Et="concavity",St="_fired",xt="style",Tt="cursor",Nt="dragstart",Ct="shadowBlur",kt="_startX",Lt="inDegrees",At="_startY",Ot="_hovered",Mt="dragging",_t="maxWidth",Dt="dragstop",Pt="animated",Ht="_mousedout",Bt="color",jt="fontFamily",Ft="hasOwnProperty",It="pixelRatio",qt="_animating",Rt="imageSmoothing",Ut="drawQuadratic",zt="<canvas />",Wt="moveTo",Xt="_masks",Vt="isPointInStroke",$t="offsetX",Jt="fontStyle",Kt="drawPolygon",Qt="drawEllipse",Gt="load",Yt="complete",Zt="setLayer",en="drawVector",tn="restoreCanvas",nn="createPattern",rn="match",sn="drawBezier",on,un=e.extend,an=e.inArray,fn=e.type,ln=e.isFunction,cn=r.round,hn=r.PI,pn=r.sin,dn=r.cos,vn=e[J].fix,mn,gn,yn,bn={},wn={},En={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},Sn,xn;e.fn[ut]=Nn;Nn[F]={};on={align:"center",autosave:s,baseline:"middle",bringToFront:o,ccw:o,closed:o,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:s,disableDrag:o,disableEvents:o,domain:u,draggable:o,group:u,data:{},each:u,end:360,fillStyle:p,font:"",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:s,fn:u,graph:"y",height:u,imageSmoothing:s,inDegrees:s,index:u,lineHeight:1,layer:o,load:u,mask:o,maxWidth:u,miterLimit:10,name:u,opacity:1,projection:0,r1:u,r2:u,radius:0,range:u,repeat:"repeat",respectAlign:o,rotate:0,rounded:o,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:p,shadowStroke:!1,shadowX:0,shadowY:0,sHeight:u,sides:0,source:"",spread:0,start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:p,strokeWidth:1,sWidth:u,sx:u,sy:u,text:"",translate:0,translateX:0,translateY:0,type:u,visible:s,width:u,x:0,y:0};Nn();Nn.extend=function(n){Nn.defaults=un(on,n.props);Nn();n[rt]&&(e.fn[n[rt]]=function r(e){var t=this,i,s,o,u=new Tn(e);for(s=0;s<t[f];s+=1){i=t[s];o=kn(i);if(o){e=Jn(i,u,e,r);Mn(i,o,u);n.fn[w](i,o,u)}}return t});return e.fn[n[rt]]};e.fn[x]=function(t){var n=this[0],r,i,s=[];if(n&&n[O]){r=In(n).layers;if(ln(t))for(i=0;i<r[f];i+=1)t[w](n,r[i])&&s.push(r[i]);else s=r}return s};e.fn[L]=function(t){var n=this[x](),r=fn(t),i=In(this[0]),s,o;if(t&&t[c])s=t;else if(r==="number"){t<0&&(t=n[f]+t);s=n[t]}else if(r==="regexp"){for(o=0;o<n[f];o+=1)if(Cn(n[o][rt])&&n[o][rt][rn](t)){s=n[o];break}}else{i=In(this[0]);s=i[c].names[t]}return s};e.fn[C]=function(t){var n=fn(t),r,i,s,o;if(n==="array")return t;if(n==="regexp"){o=In(this[0]);r=o[dt];for(i in r)if(i[rn](t)){s=r[i];break}}else{o=In(this[0]);s=o[c][dt][t]}return s};e.fn.getLayerIndex=function(t){var n=this[x](),r=this[L](t);return an(r,n)};e.fn[Zt]=function(n,r){var i=this,s,o,u,l;for(o=0;o<i[f];o+=1){s=e(i[o]);u=In(i[o]);l=e(i[o])[L](n);if(l){zn(s,u,l,r);Wn(s,u,l,r);r[D]!==a&&s.moveLayer(l,r[D]);un(l,r);qn(s,u,l);Un(s,u,l)}}return i};e.fn.setLayerGroup=function(n,r){var i=this,s,o,u,a;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[C](n);if(u)for(a=0;a<u[f];a+=1)s[Zt](u[a],r)}return i};e.fn.setLayers=function(n){var r=this,i,s,o,u;for(s=0;s<r[f];s+=1){i=e(r[s]);o=e(r[s])[x]();for(u=0;u<o[f];u+=1)i[Zt](o[u],n)}return r};e.fn.moveLayer=function(n,r){var i=this,s,o,u,a;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[x]();a=s[L](n);if(a){a[D]=an(a,u);u[b](a[D],1);u[b](r,0,a);r<0&&(r=u[f]+r);a[D]=r}}return i};e.fn.removeLayer=function(n){var r=this,i,s,o,a,l;for(s=0;s<r[f];s+=1){i=e(r[s]);o=In(r[s]);a=i[x]();l=i[L](n);if(l){l[D]=an(l,a);a[b](l[D],1);zn(i,o,l,{name:u});Wn(i,o,l,{group:u})}}return r};e.fn.removeLayerGroup=function(n){var r=this,i,s,o,l,h,p,d;if(n!==a)for(s=0;s<r[f];s+=1){i=e(r[s]);o=In(r[s]);l=i[x]();h=i[C](n);if(h){for(d=0;d<h[f];d+=1){p=h[d];p[D]=an(p,l);l[b](p[D],1);zn(i,o,p,{name:u})}delete o[c][dt][h[rt]]}}return r};e.fn.removeLayers=function(){var n=this,r,i,s;for(i=0;i<n[f];i+=1){r=e(n[i]);s=In(n[i]);s.layers[f]=0;s[c].names={};s[c][dt]={}}return n};e.fn.drawLayer=function(n){var r=this,i,s,o,u;for(i=0;i<r[f];i+=1){o=e(r[i]);s=kn(r[i]);u=o[L](n);$n(o,s,u)}return r};e.fn[H]=function(n){var r=this,i,u,a,l=un({},n),h,p,m,g,y,b,E,x,T;l[D]||(l[D]=0);for(u=0;u<r[f];u+=1){i=e(r[u]);a=kn(r[u]);if(a){y=In(r[u]);l.clear!==o&&i.clearCanvas();h=y.layers;for(m=l[D];m<h[f];m+=1){p=h[m];p[D]=m;l.resetFire&&(p[St]=o);p[v]=!p.disableEvents;$n(i,a,p,m+1);p[Xt]=y[d].masks[gt](0);if(p[Ht]){p[Ht]=o;p[St]=s;p[Ot]=o;p[Z]&&p[Z][w](r[u],p);p[Tt]&&p._cursor&&i.css({cursor:p._cursor})}if(p[A]===e.fn[G]&&p[S])break}g=m;p=Xn(y);b=y[J];E=b.type;p[E]||(E=nr(E));T=p[E];x=y.drag;if(p[v]&&p[K]){if(p[W]||p[Z]||p[Tt])if(!p[Ot]&&!p[St]){p[St]=s;p[Ot]=s;p[W]&&p[W][w](r[u],p);if(p[Tt]){p._cursor=i.css(Tt);i.css({cursor:p[Tt]})}}if(T&&!p[St]){p[St]=s;T[w](r[u],p)}p[$]&&!p.disableDrag&&(E===V||E===at)&&(x[c]=p)}x[c]&&Vn(r[u],y);if(g===h[f]){y[Y][f]=0;y[d]=Ln(En);y[M][f]=0}}}return r};e.fn.addLayer=function(t){var n=this,r,i,o=new Tn(t);for(r=0;r<n[f];r+=1){i=kn(n[r]);if(i){o[c]=s;t=Jn(n[r],o,t)}}return n};Sn=[h,l,"opacity",et];xn={};e.fn.animateLayer=function(){function m(e,t,n){return function(){Kn(n);(!t[tt]||t[Pt]===n)&&e[H]();c[4]&&c[4][w](e[0],n);n[qt]=o;t[tt]=o;t[Pt]=u}}function g(e,t,n){return function(r,i){if(i.pos!==v){v=i.pos;Kn(n);if(!n[qt]&&!t[tt]){n[qt]=s;t[tt]=s;t[Pt]=n}(!t[tt]||t[Pt]===n)&&e[H]();c[5]&&c[5][w](e[0],r,i,n)}}}var n=this,r,i,l,c=[][gt][w](arguments,0),h,p,d,v=0;if(fn(c[2])==="object"){c[b](2,0,c[2].duration||u);c[b](3,0,c[3].easing||u);c[b](4,0,c[4].done||c[4][Yt]||u);c[b](5,0,c[5].step||u)}else{if(c[2]===a){c[b](2,0,u);c[b](3,0,u);c[b](4,0,u)}else if(ln(c[2])){c[b](2,0,u);c[b](3,0,u)}if(c[3]===a){c[3]=u;c[b](4,0,u)}else ln(c[3])&&c[b](3,0,u)}for(i=0;i<n[f];i+=1){r=e(n[i]);l=kn(n[i]);if(l){h=In(n[i]);p=r[L](c[0]);if(p&&p[A]!==e.fn.draw){d=un({},c[1]);d=Gn(n[i],p,d);Qn(d,s);Qn(p);p[xt]=xn;e(p).animate(d,{duration:c[2],easing:e.easing[c[3]]?c[3]:u,complete:m(r,h,p),step:g(r,h,p)})}}}return n};e.fn.animateLayerGroup=function(n){var r=this,i,s,o=[][gt][w](arguments,0),u,a;for(s=0;s<r[f];s+=1){i=e(r[s]);u=i[C](n);if(u)for(a=0;a<u[f];a+=1)i.animateLayer.apply(i,[u[a]].concat(o[gt](1)))}return r};e.fn.delayLayer=function(n,r){var i=this,s,o;r=r||0;for(s=0;s<i[f];s+=1){o=e(i[s])[L](n);e(o).delay(r)}return i};e.fn.delayLayerGroup=function(n,r){var i=this,s,o,u,a,l;r=r||0;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[C](n);if(u)for(l=0;l<u[f];l+=1){a=u[l];a&&e(a).delay(r)}}return i};e.fn.stopLayer=function(n,r){var i=this,s,o,u;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[L](n);u&&e(u).stop(r)}return i};e.fn.stopLayerGroup=function(n,r){var i=this,s,o,u,a,l;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[C](n);if(u)for(l=0;l<u[f];l+=1){a=u[l];a&&e(a).stop(r)}}return i};er([Bt,"backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor",E,"outlineColor",N,m]);mn={mousedown:at,mouseup:wt,mousemove:vt};gn={touchstart:V,touchend:nt,touchmove:P};ir(["click","dblclick",V,nt,P,W,Z,at,vt,wt]);e[J].fix=function(t){var n,r,i;t=vn[w](e[J],t);r=t.originalEvent;if(r){i=r.changedTouches;if(t.pageX!==a&&t[$t]===a){n=e(t.target).offset();if(n){t[$t]=t.pageX-n.left;t.offsetY=t.pageY-n.top}}else if(i){n=e(r.target).offset();if(n){t[$t]=i[0].pageX-n.left;t.offsetY=i[0].pageY-n.top}}}return t};yn={arc:"drawArc",bezier:sn,ellipse:Qt,"function":"draw",image:G,line:"drawLine",polygon:Kt,slice:"drawSlice",quadratic:Ut,rectangle:"drawRect",text:"drawText",vector:en};e.fn.draw=function fr(t){var n=this,r,i,s,o;o=new Tn(t);for(i=0;i<n[f];i+=1){r=e(n[i]);s=kn(n[i]);if(s){t=Jn(n[i],o,t,fr);o[S]&&(o.fn?o.fn[w](n[i],s,o):o[A]!==fr&&o[A][w](r,t))}}return n};e.fn.clearCanvas=function(t){var n=this,r,i,s=new Tn(t);for(r=0;r<n[f];r+=1){i=kn(n[r]);if(i)if(s[h]===u||s[l]===u){i.save();i.setTransform(1,0,0,1,0,0);i.clearRect(0,0,n[r][h],n[r][l]);i[lt]()}else{Fn(n[r],i,s,s[h],s[l]);i.clearRect(s.x-s[h]/2,s.y-s[l]/2,s[h],s[l]);i[lt]()}}return n};e.fn.saveCanvas=function lr(e){var t=this,n,r,i=new Tn(e),s,o;for(n=0;n<t[f];n+=1){r=kn(t[n]);if(r){s=In(t[n]);e=Jn(t[n],i,e,lr);for(o=0;o<i.count;o+=1)An(r,s)}}return t};e.fn[tn]=function cr(e){var t=this,n,r,i=new Tn(e),s,o;for(n=0;n<t[f];n+=1){r=kn(t[n]);if(r){s=In(t[n]);e=Jn(t[n],i,e,cr);for(o=0;o<i.count;o+=1)On(r,s)}}return t};e.fn.restoreCanvasOnRedraw=function(t){var n=this,r=un({},t);r[c]=s;n[tn](r);return n};e.fn.rotateCanvas=function hr(e){var t=this,n,r,i=new Tn(e),s;for(n=0;n<t[f];n+=1){r=kn(t[n]);if(r){s=In(t[n]);e=Jn(t[n],i,e,hr);i[mt]&&An(r,s);Hn(r,i,s[d])}}return t};e.fn.scaleCanvas=function pr(e){var t=this,n,r,i=new Tn(e),s;for(n=0;n<t[f];n+=1){r=kn(t[n]);if(r){s=In(t[n]);e=Jn(t[n],i,e,pr);i[mt]&&An(r,s);Bn(r,i,s[d])}}return t};e.fn.translateCanvas=function dr(e){var t=this,n,r,i=new Tn(e),s;for(n=0;n<t[f];n+=1){r=kn(t[n]);if(r){s=In(t[n]);e=Jn(t[n],i,e,dr);i[mt]&&An(r,s);jn(r,i,s[d])}}return t};e.fn.drawRect=function vr(e){var t=this,n,r,i=new Tn(e),u,a,c,p,d;for(n=0;n<t[f];n+=1){r=kn(t[n]);if(r){e=Jn(t[n],i,e,vr);if(i[S]){Mn(t[n],r,i);Fn(t[n],r,i,i[h],i[l]);r[g]();u=i.x-i[h]/2;a=i.y-i[l]/2;d=i.cornerRadius;if(d){i[pt]=s;c=i.x+i[h]/2;p=i.y+i[l]/2;c-u-2*d<0&&(d=(c-u)/2);p-a-2*d<0&&(d=(p-a)/2);r[Wt](u+d,a);r[st](c-d,a);r.arc(c-d,a+d,d,3*hn/2,hn*2,o);r[st](c,p-d);r.arc(c-d,p-d,d,0,hn/2,o);r[st](u+d,p);r.arc(u+d,p-d,d,hn/2,hn,o);r[st](u,a+d);r.arc(u+d,a+d,d,hn,3*hn/2,o)}else r.rect(u,a,i[h],i[l]);i[v]&&sr(t[n],r,i);Pn(t[n],r,i)}}}return t};e.fn.drawArc=function mr(e){var t=this,n,r,i=new Tn(e);e=e||{};i[c]&&!i[Lt]&&i.end===360&&(e.end=i.end=hn*2);for(n=0;n<t[f];n+=1){r=kn(t[n]);if(r){e=Jn(t[n],i,e,mr);if(i[S]){Mn(t[n],r,i);Fn(t[n],r,i,i[Q]*2);i[U]*=i[j];i.end*=i[j];i[U]-=hn/2;i.end-=hn/2;r[g]();r.arc(i.x,i.y,i[Q],i[U],i.end,i.ccw);i[v]&&sr(t[n],r,i);Pn(t[n],r,i)}}}return t};e.fn[Qt]=function gr(e){var t=this,n,r,i=new Tn(e),o=i[h]*(4/3),u=i[l];i[pt]=s;for(n=0;n<t[f];n+=1){r=kn(t[n]);if(r){e=Jn(t[n],i,e,gr);if(i[S]){Mn(t[n],r,i);Fn(t[n],r,i,i[h],i[l]);r[g]();r[Wt](i.x,i.y-u/2);r[yt](i.x-o/2,i.y-u/2,i.x-o/2,i.y+u/2,i.x,i.y+u/2);r[yt](i.x+o/2,i.y+u/2,i.x+o/2,i.y-u/2,i.x,i.y-u/2);i[v]&&sr(t[n],r,i);Pn(t[n],r,i)}}}return t};e.fn[Kt]=function yr(e){var t=this,n,r,i=new Tn(e),o=2*hn/i.sides,u=o/2,a=u+hn/2,l=i[Q]*dn(u),c,h,p;i.projection&&(i[Et]=-i.projection);for(n=0;n<t[f];n+=1){r=kn(t[n]);if(r){e=Jn(t[n],i,e,yr);if(i[S]){Mn(t[n],r,i);Fn(t[n],r,i,i[Q]*2);r[g]();for(p=0;p<i.sides;p+=1){c=i.x+i[Q]*dn(a);h=i.y+i[Q]*pn(a);r[st](c,h);if(i[Et]){c=i.x+(l+ -l*i[Et])*dn(a+u);h=i.y+(l+ -l*i[Et])*pn(a+u);r[st](c,h)}a+=o}i[v]&&sr(t[n],r,i);i[pt]=s;Pn(t[n],r,i)}}}return t};e.fn.drawSlice=function br(t){var n=this,r,i,o,u=new Tn(t),a,l,c;for(i=0;i<n[f];i+=1){r=e(n[i]);o=kn(n[i]);if(o){t=Jn(n[i],u,t,br);if(u[S]){Mn(n[i],o,u);Fn(n[i],o,u,u[Q]*2);if(i===0){u[U]*=u[j];u.end*=u[j];u[U]-=hn/2;u.end-=hn/2;while(u[U]<0)u[U]+=2*hn;while(u.end<0)u.end+=2*hn;u.end<u[U]&&(u.end+=2*hn);a=(u[U]+u.end)/2;l=u[Q]*u.spread*dn(a);c=u[Q]*u.spread*pn(a);u.x+=l;u.y+=c}o[g]();o.arc(u.x,u.y,u[Q],u[U],u.end,u.ccw);o[st](u.x,u.y);u[v]&&sr(n[i],o,u);u[pt]=s;Pn(n[i],o,u)}}}return n};e.fn.drawLine=function wr(e){var t=this,n,r,i=new Tn(e),o,u,l;for(n=0;n<t[f];n+=1){r=kn(t[n]);if(r){e=Jn(t[n],i,e,wr);if(i[S]){Mn(t[n],r,i);Fn(t[n],r,i,0);o=1;r[g]();while(s){u=i["x"+o];l=i["y"+o];if(u===a||l===a)break;r[st](u+i.x,l+i.y);o+=1}i[v]&&sr(t[n],r,i);Pn(t[n],r,i)}}}return t};e.fn[Ut]=e.fn.drawQuad=function Er(e){var t=this,n,r,i=new Tn(e),o,u,l,c,h;for(n=0;n<t[f];n+=1){r=kn(t[n]);if(r){e=Jn(t[n],i,e,Er);if(i[S]){Mn(t[n],r,i);Fn(t[n],r,i,0);o=2;r[g]();r[Wt](i.x1+i.x,i.y1+i.y);while(s){u=i["x"+o];l=i["y"+o];c=i["cx"+(o-1)];h=i["cy"+(o-1)];if(u===a||l===a||c===a||h===a)break;r.quadraticCurveTo(c+i.x,h+i.y,u+i.x,l+i.y);o+=1}i[v]&&sr(t[n],r,i);Pn(t[n],r,i)}}}return t};e.fn[sn]=function Sr(e){var t=this,n,r,i=new Tn(e),o,u,l,c,h,p,d,m;for(n=0;n<t[f];n+=1){r=kn(t[n]);if(r){e=Jn(t[n],i,e,Sr);if(i[S]){Mn(t[n],r,i);Fn(t[n],r,i,0);o=2;u=1;r[g]();r[Wt](i.x1+i.x,i.y1+i.y);while(s){l=i["x"+o];c=i["y"+o];h=i["cx"+u];p=i["cy"+u];d=i["cx"+(u+1)];m=i["cy"+(u+1)];if(l===a||c===a||h===a||p===a||d===a||m===a)break;r[yt](h+i.x,p+i.y,d+i.x,m+i.y,l+i.x,c+i.y);o+=1;u+=2}i[v]&&sr(t[n],r,i);Pn(t[n],r,i)}}}return t};e.fn[en]=function xr(e){var t=this,n,i,o=new Tn(e),u,l,c,h,p;for(n=0;n<t[f];n+=1){i=kn(t[n]);if(i){e=Jn(t[n],o,e,xr);if(o[S]){Mn(t[n],i,o);Fn(t[n],i,o,0);u=1;i[g]();h=o.x;p=o.y;i[Wt](o.x,o.y);while(s){l=o["a"+u];c=o["l"+u];if(l===a||c===a)break;l*=o[j];l-=hn/2;h+=c*r.cos(l);p+=c*r.sin(l);i[st](h,p);u+=1}o[v]&&sr(t[n],i,o);Pn(t[n],i,o)}}}return t};e.fn.drawText=function Tr(t){var n=this,r,i,s,o=new Tn(t),a,d,y,b;for(i=0;i<n[f];i+=1){r=e(n[i]);s=kn(n[i]);if(s){t=Jn(n[i],o,t,Tr);if(o[S]){Mn(n[i],s,o);s.textBaseline=o.baseline;s.textAlign=o.align;or(s,o);i||(o[_t]!==u?a=ar(s,o):a=o.text.toString().split("\n"));if(!i){ur(n[i],s,o,a);if(t&&o[c]){t[h]=o[h];t[l]=o[l]}y=o.x;o.align==="left"?o.respectAlign?o.x+=o[h]/2:y-=o[h]/2:o.align==="right"&&(o.respectAlign?o.x-=o[h]/2:y+=o[h]/2)}Fn(n[i],s,o,o[h],o[l]);for(d=0;d<a[f];d+=1){s[m]=o[m];b=o.y+d*o[l]/a[f]-(a[f]-1)*o[l]/a[f]/2;s.fillText(a[d],y,b);o[E]!==p&&(s[m]=p);s.strokeText(a[d],y,b)}if(o[v]){s[g]();s.rect(o.x-o[h]/2,o.y-o[l]/2,o[h],o[l]);sr(n[i],s,o);s[z]()}Dn(s,o)}}}bn=o;return n};e.fn[R]=function Nr(e){var t=this,n,r,i;e===a||fn(e)==="object"&&!e[c]?r=new Tn(e):r=t[L](e);n=kn(t[0]);if(n){or(n,r);i=ar(n,r);Nr(t[0],n,r,i)}return r};e.fn[G]=function Cr(t){function N(e,n,i){if(e===0){b[h]===u&&b[X]===u&&(b[h]=b[X]=E[h]);b[l]===u&&b[_]===u&&(b[l]=b[_]=E[l]);if(t&&b[c]){t[h]=b[h];t[l]=b[l]}}if(b[X]!==u&&b[_]!==u&&b.sx!==u&&b.sy!==u){if(e===0){b[h]===u&&(b[h]=b[X]);b[l]===u&&(b[l]=b[_]);if(!b.cropFromCenter){b.sx+=b[X]/2;b.sy+=b[_]/2}b.sy-b[_]/2<0&&(b.sy=b[_]/2);b.sy+b[_]/2>E[l]&&(b.sy=E[l]-b[_]/2);b.sx-b[X]/2<0&&(b.sx=b[X]/2);b.sx+b[X]/2>E[h]&&(b.sx=E[h]-b[X]/2)}Fn(r[e],n,b,b[h],b[l]);n[G](E,b.sx-b[X]/2,b.sy-b[_]/2,b[X],b[_],b.x-b[h]/2,b.y-b[l]/2,b[h],b[l])}else{Fn(r[e],n,b,b[h],b[l]);n[G](E,b.x-b[h]/2,b.y-b[l]/2,b[h],b[l])}Mn(r[e],n,b);n[g]();n.rect(b.x-b[h]/2,b.y-b[l]/2,b[h],b[l]);b[v]&&sr(r[e],n,b);n[z]();n.stroke();Dn(n,b);_n(n,i,b)}function C(n,r,i,u){return function(){N(r,i,u);b[Gt]&&b[Gt][w](n,t);if(b[c]){b._args[Xt]=u[d].masks[gt](0);b._next&&e(n)[H]({clear:o,resetFire:s,index:b._next})}}}var r=this,i,p,m,y,b=new Tn(t),E,x,T;T=b.source;x=T[O];if(T.src||x)E=T;else if(T)if(wn[T]!==a)E=wn[T];else{E=new n;E.src=T;wn[T]=E}for(p=0;p<r[f];p+=1){i=r[p];m=kn(r[p]);if(m){y=In(r[p]);t=Jn(r[p],b,t,Cr);if(b[S]&&E)if(E[Yt]||x)C(i,p,m,y)();else{e(E).bind(Gt,C(i,p,m,y));E.src=E.src}}}return r};e.fn[nn]=e.fn.pattern=function(r){function d(){f=s[nn](a,o.repeat);o[Gt]&&o[Gt][w](i[0],f)}var i=this,s,o=new Tn(r),a,f,c,p;s=kn(i[0]);if(s){p=o.source;if(ln(p)){a=e(zt)[0];a[h]=o[h];a[l]=o[l];c=kn(a);p[w](a,c);d()}else{c=p[O];if(p.src||c)a=p;else{a=new n;a.src=p}if(a[Yt]||c)d();else{e(a).bind(Gt,d);a.src=a.src}}}else f=u;return f};e.fn.createGradient=e.fn.gradient=function(t){var n=this,r,i=new Tn(t),s,o=[],l,c,h,p,d,v,m;r=kn(n[0]);if(r){i.x1=i.x1||0;i.y1=i.y1||0;i.x2=i.x2||0;i.y2=i.y2||0;i.r1!==u||i.r2!==u?s=r.createRadialGradient(i.x1,i.y1,i.r1,i.x2,i.y2,i.r2):s=r.createLinearGradient(i.x1,i.y1,i.x2,i.y2);for(p=1;i["c"+p]!==a;p+=1)i["s"+p]!==a?o.push(i["s"+p]):o.push(u);l=o[f];o[0]===u&&(o[0]=0);o[l-1]===u&&(o[l-1]=1);for(p=0;p<l;p+=1){if(o[p]!==u){v=1;m=0;c=o[p];for(d=p+1;d<l;d+=1){if(o[d]!==u){h=o[d];break}v+=1}c>h&&(o[d]=o[p])}else if(o[p]===u){m+=1;o[p]=c+m*((h-c)/v)}s.addColorStop(o[p],i["c"+(p+1)])}}else s=u;return s};e.fn.setPixels=function kr(e){var t=this,n,r,i,s=new Tn(e),o={},a,c,p,d;for(r=0;r<t[f];r+=1){n=t[r];i=kn(n);if(i){e=Jn(n,s,e,kr);Fn(t[r],i,s,s[h],s[l]);if(s[h]===u||s[l]===u){s[h]=n[h];s[l]=n[l];s.x=s[h]/2;s.y=s[l]/2}if(s[h]!==0&&s[l]!==0){a=i.getImageData(s.x-s[h]/2,s.y-s[l]/2,s[h],s[l]);c=a.data;d=c[f];o=[];if(s.each)for(p=0;p<d;p+=4){o.r=c[p];o.g=c[p+1];o.b=c[p+2];o.a=c[p+3];s.each[w](n,o);c[p]=o.r;c[p+1]=o.g;c[p+2]=o.b;c[p+3]=o.a}i.putImageData(a,s.x-s[h]/2,s.y-s[l]/2);i[lt]()}}}return t};e.fn.getCanvasImage=function(t,n){var r=this[0];n===a&&(n=1);return r&&r.toDataURL?r.toDataURL("image/"+t,n):u};e.fn.detectPixelRatio=function(n){var r=this,i,o,u,a,c,p,d,v,m,g;for(u=0;u<r[f];u+=1){o=r[u];i=e(r[u]);a=kn(o);g=In(r[u]);if(!g.scaled){c=window.devicePixelRatio||1;p=a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;d=c/p;if(d!==1){v=o[h];m=o[l];o[h]=v*d;o[l]=m*d;o[xt][h]=v+"px";o[xt][l]=m+"px";a.scale(d,d)}g[It]=d;g.scaled=s;n&&n[w](o,d)}}return r};e.support.canvas=e(zt)[0][O]!==a;Nn.defaults=on;Nn.detectEvents=sr;Nn[z]=Pn;Nn.getTouchEventName=tr;e[ut]=Nn})(jQuery,document,Image,Math,parseFloat,!0,!1,null);